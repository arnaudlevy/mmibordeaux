<p id="notice"><%= notice %></p>

<h1><%= @semester %></h1>
<%= link_to 'Edit', edit_semester_path(@semester) %>
<p>Heures étudiant : <%= @semester.planned_student_hours.round %> planifiées / <%= @semester.expected_student_hours.round %> PPN</p>
<div id="semester-<%= @semester.id %>"></div></td>
<script type="text/javascript">
  $(function () {
    $('#semester-<%= @semester.id %>').highcharts({
        chart: { type: 'bar', height: 150 },
        title: null,
        xAxis: { categories: ['PPN', 'Planifié'], tickWidth: 0 },
        yAxis: { min: 0, title: null },
        tooltip: { backgroundColor: 'white', valueSuffix: ' heures' },
        plotOptions: { series: { stacking: 'normal', dataLabels: { enabled: false } } },
        legend: { enabled: false },
        credits: { enabled: false },
        series: [
          { name: 'TP', data: [<%= @semester.student_hours_tp %>, <%= @semester.planned_student_hours_tp %>] }, 
          { name: 'TD', data: [<%= @semester.student_hours_td %>, <%= @semester.planned_student_hours_td %>] }, 
          { name: 'CM', data: [<%= @semester.student_hours_cm %>, <%= @semester.planned_student_hours_cm %>] }
          ]
    });
});
</script>

<h3><%= @semester.teaching_modules.count %> modules</h3>
<table class="table table-hover">
  <thead>
    <tr>
      <th>Code</th>
      <th>Nom</th>
      <th>Heures étudiant planifiées</th>
      <th>Delta d'heures</th>
      <th>Unité</th>
      <th>Categorie</th>
    </tr>
  </thead>
  <tbody>
    <% @semester.teaching_modules.each do |teaching_module| %>
      <tr>
        <td><%= link_to teaching_module.code, teaching_module %></td>
        <td><%= link_to teaching_module.label, teaching_module %></td>
        <td><%= teaching_module.student_hours.round %></td>
        <td><%= number_to_percentage teaching_module.student_hours_delta, precision: 0 %></td>
        <td><%= link_to teaching_module.teaching_unit, teaching_module.teaching_unit %></td>
        <td><%= link_to teaching_module.teaching_category, teaching_module.teaching_category %></td>
      </tr>
    <% end %>
  </tbody>
</table>
